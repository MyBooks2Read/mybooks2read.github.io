<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p261" style="overflow: hidden; position: relative; background-color: white; width: 811px; height: 1017px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_261{left:702px;bottom:960px;letter-spacing:-0.13px;}
#t2_261{left:321px;bottom:961px;letter-spacing:-0.16px;}
#t3_261{left:352px;bottom:961px;letter-spacing:-0.13px;word-spacing:0.01px;}
#t4_261{left:174px;bottom:917px;letter-spacing:0.12px;word-spacing:3.77px;}
#t5_261{left:636px;bottom:917px;letter-spacing:-0.32px;}
#t6_261{left:174px;bottom:899px;letter-spacing:0.13px;}
#t7_261{left:464px;bottom:899px;}
#t8_261{left:156px;bottom:869px;letter-spacing:0.12px;}
#t9_261{left:156px;bottom:849px;letter-spacing:0.12px;word-spacing:-0.02px;}
#ta_261{left:156px;bottom:787px;letter-spacing:0.13px;}
#tb_261{left:185px;bottom:771px;letter-spacing:0.14px;word-spacing:-0.03px;}
#tc_261{left:185px;bottom:741px;letter-spacing:0.14px;word-spacing:-0.05px;}
#td_261{left:185px;bottom:726px;letter-spacing:0.14px;word-spacing:-0.05px;}
#te_261{left:185px;bottom:710px;letter-spacing:0.14px;word-spacing:-0.05px;}
#tf_261{left:185px;bottom:695px;letter-spacing:0.14px;word-spacing:-0.02px;}
#tg_261{left:215px;bottom:680px;letter-spacing:0.14px;word-spacing:-0.02px;}
#th_261{left:215px;bottom:664px;letter-spacing:0.14px;word-spacing:-0.02px;}
#ti_261{left:215px;bottom:649px;letter-spacing:0.14px;word-spacing:-0.02px;}
#tj_261{left:185px;bottom:619px;letter-spacing:0.14px;word-spacing:-0.02px;}
#tk_261{left:215px;bottom:603px;letter-spacing:0.14px;}
#tl_261{left:244px;bottom:588px;letter-spacing:0.14px;}
#tm_261{left:244px;bottom:573px;letter-spacing:0.14px;word-spacing:-0.01px;}
#tn_261{left:244px;bottom:557px;letter-spacing:0.14px;word-spacing:-0.01px;}
#to_261{left:244px;bottom:542px;letter-spacing:0.14px;word-spacing:-0.01px;}
#tp_261{left:185px;bottom:512px;letter-spacing:0.13px;word-spacing:0.01px;}
#tq_261{left:156px;bottom:475px;letter-spacing:0.12px;word-spacing:-0.13px;}
#tr_261{left:156px;bottom:455px;letter-spacing:0.12px;word-spacing:0.86px;}
#ts_261{left:432px;bottom:455px;}
#tt_261{left:437px;bottom:455px;letter-spacing:0.11px;word-spacing:0.84px;}
#tu_261{left:156px;bottom:435px;letter-spacing:0.14px;word-spacing:-0.15px;}
#tv_261{left:241px;bottom:435px;}
#tw_261{left:250px;bottom:435px;letter-spacing:0.13px;word-spacing:-0.09px;}
#tx_261{left:156px;bottom:415px;letter-spacing:0.12px;word-spacing:0.01px;}
#ty_261{left:463px;bottom:415px;}
#tz_261{left:471px;bottom:415px;letter-spacing:0.11px;}
#t10_261{left:156px;bottom:385px;letter-spacing:0.14px;}
#t11_261{left:156px;bottom:354px;letter-spacing:0.13px;word-spacing:0.01px;}
#t12_261{left:185px;bottom:339px;letter-spacing:0.14px;word-spacing:-0.02px;}
#t13_261{left:215px;bottom:324px;letter-spacing:0.14px;}
#t14_261{left:244px;bottom:308px;letter-spacing:0.13px;}
#t15_261{left:185px;bottom:293px;letter-spacing:0.13px;word-spacing:0.01px;}
#t16_261{left:156px;bottom:236px;letter-spacing:0.11px;}
#t17_261{left:156px;bottom:206px;letter-spacing:0.13px;word-spacing:0.01px;}
#t18_261{left:156px;bottom:191px;letter-spacing:0.12px;word-spacing:0.01px;}
#t19_261{left:244px;bottom:191px;letter-spacing:0.12px;}
#t1a_261{left:295px;bottom:191px;letter-spacing:0.13px;}
#t1b_261{left:486px;bottom:191px;letter-spacing:0.12px;}
#t1c_261{left:530px;bottom:191px;letter-spacing:0.12px;}
#t1d_261{left:582px;bottom:191px;letter-spacing:0.14px;}
#t1e_261{left:156px;bottom:175px;letter-spacing:0.12px;word-spacing:0.01px;}
#t1f_261{left:244px;bottom:175px;letter-spacing:0.12px;}
#t1g_261{left:295px;bottom:175px;letter-spacing:0.12px;}
#t1h_261{left:340px;bottom:175px;letter-spacing:0.12px;}
#t1i_261{left:391px;bottom:175px;letter-spacing:0.13px;}
#t1j_261{left:582px;bottom:175px;letter-spacing:0.14px;}
#t1k_261{left:156px;bottom:160px;letter-spacing:0.12px;word-spacing:0.01px;}
#t1l_261{left:244px;bottom:160px;letter-spacing:0.12px;}
#t1m_261{left:295px;bottom:160px;letter-spacing:0.12px;}
#t1n_261{left:340px;bottom:160px;letter-spacing:0.12px;}
#t1o_261{left:391px;bottom:160px;letter-spacing:0.09px;}
#t1p_261{left:435px;bottom:160px;letter-spacing:0.12px;}
#t1q_261{left:486px;bottom:160px;letter-spacing:0.12px;}
#t1r_261{left:530px;bottom:160px;letter-spacing:0.12px;}
#t1s_261{left:582px;bottom:160px;letter-spacing:0.14px;}
#t1t_261{left:156px;bottom:145px;letter-spacing:0.13px;word-spacing:0.01px;}
#t1u_261{left:156px;bottom:130px;letter-spacing:0.13px;word-spacing:0.01px;}
#t1v_261{left:156px;bottom:114px;letter-spacing:0.13px;word-spacing:0.01px;}
#t1w_261{left:174px;bottom:815px;letter-spacing:-0.12px;word-spacing:0.02px;}
#t1x_261{left:262px;bottom:815px;letter-spacing:-0.13px;word-spacing:0.01px;}
#t1y_261{left:501px;bottom:755px;letter-spacing:-0.12px;word-spacing:-0.25px;}
#t1z_261{left:513px;bottom:741px;letter-spacing:-0.11px;word-spacing:0.03px;}
#t20_261{left:516px;bottom:726px;letter-spacing:-0.09px;word-spacing:-0.04px;}
#t21_261{left:505px;bottom:712px;letter-spacing:-0.09px;word-spacing:-0.03px;}
#t22_261{left:502px;bottom:697px;letter-spacing:-0.1px;}
#t23_261{left:582px;bottom:683px;letter-spacing:-0.11px;word-spacing:0.05px;}
#t24_261{left:601px;bottom:668px;letter-spacing:-0.1px;word-spacing:-0.01px;}
#t25_261{left:584px;bottom:545px;letter-spacing:-0.1px;word-spacing:0.03px;}
#t26_261{left:584px;bottom:531px;letter-spacing:-0.1px;word-spacing:-0.01px;}
#t27_261{left:584px;bottom:516px;letter-spacing:-0.09px;word-spacing:-0.04px;}
#t28_261{left:466px;bottom:376px;letter-spacing:-0.12px;word-spacing:-0.41px;}
#t29_261{left:466px;bottom:361px;letter-spacing:-0.1px;word-spacing:0.01px;}
#t2a_261{left:476px;bottom:299px;letter-spacing:-0.1px;word-spacing:-0.02px;}
#t2b_261{left:476px;bottom:284px;letter-spacing:-0.1px;word-spacing:-0.55px;}
#t2c_261{left:476px;bottom:270px;letter-spacing:-0.09px;}
#t2d_261{left:640px;bottom:199px;letter-spacing:-0.11px;word-spacing:0.07px;}
#t2e_261{left:640px;bottom:185px;letter-spacing:-0.11px;word-spacing:-0.03px;}
#t2f_261{left:640px;bottom:170px;letter-spacing:-0.09px;word-spacing:-0.04px;}
#t2g_261{left:640px;bottom:155px;letter-spacing:-0.09px;word-spacing:-0.04px;}
#t2h_261{left:640px;bottom:141px;letter-spacing:-0.11px;word-spacing:0.08px;}

.s1_261{font-size:14px;font-family:NewBaskerville-Bold_ay9;color:#000;}
.s2_261{font-size:14px;font-family:NewBaskerville-BoldItalic_aya;color:#656565;}
.s3_261{font-size:15px;font-family:NewBaskerville-Roman_ay8;color:#252525;}
.s4_261{font-size:15px;font-family:NewBaskerville-Roman_ay8;color:#001CA6;}
.s5_261{font-size:12px;font-family:Courier_ahu;color:#252525;}
.s6_261{font-size:15px;font-family:NewBaskerville-Italic_avr;color:#252525;}
.s7_261{font-size:12px;font-family:Courier_ahu;color:#000;}
.s8_261{font-size:14px;font-family:FranklinGothic-Demi_ayb;color:#FFF;}
.s9_261{font-size:14px;font-family:Humanist521BT-BoldCondensed_aid;color:#656565;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts261" type="text/css" >

@font-face {
	font-family: Courier_ahu;
	src: url("fonts/Courier_ahu.woff") format("woff");
}

@font-face {
	font-family: FranklinGothic-Demi_ayb;
	src: url("fonts/FranklinGothic-Demi_ayb.woff") format("woff");
}

@font-face {
	font-family: Humanist521BT-BoldCondensed_aid;
	src: url("fonts/Humanist521BT-BoldCondensed_aid.woff") format("woff");
}

@font-face {
	font-family: NewBaskerville-BoldItalic_aya;
	src: url("fonts/NewBaskerville-BoldItalic_aya.woff") format("woff");
}

@font-face {
	font-family: NewBaskerville-Bold_ay9;
	src: url("fonts/NewBaskerville-Bold_ay9.woff") format("woff");
}

@font-face {
	font-family: NewBaskerville-Italic_avr;
	src: url("fonts/NewBaskerville-Italic_avr.woff") format("woff");
}

@font-face {
	font-family: NewBaskerville-Roman_ay8;
	src: url("fonts/NewBaskerville-Roman_ay8.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg261Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg261" style="-webkit-user-select: none;"><object width="811" height="1017" data="261/261.svg" type="image/svg+xml" id="pdf261" style="width:811px; height:1017px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_261" class="t s1_261">237 </span><span id="t2_261" class="t s2_261">7.3 </span><span id="t3_261" class="t s2_261">Understanding NURBS </span>
<span id="t4_261" class="t s3_261">“An Interactive Introduction to Splines,” by Evgeny Demidov, at </span><span id="t5_261" class="t s4_261">https:// </span>
<span id="t6_261" class="t s4_261">www.ibiblio.org/e-notes/Splines/Intro.htm</span><span id="t7_261" class="t s3_261">. </span>
<span id="t8_261" class="t s3_261">The following listing is an implementation of the algorithm in Python (ch_07/nurbs_ </span>
<span id="t9_261" class="t s3_261">circle.py in the book’s source code). </span>
<span id="ta_261" class="t s5_261">def nurbs_in_t(t, control_xs, control_ys, control_ws, knot, p): </span>
<span id="tb_261" class="t s5_261">k = index_in_knots(t, knot) </span>
<span id="tc_261" class="t s5_261">d_x = [] </span>
<span id="td_261" class="t s5_261">d_y = [] </span>
<span id="te_261" class="t s5_261">d_w = [] </span>
<span id="tf_261" class="t s5_261">for j in range(p + 1): </span>
<span id="tg_261" class="t s5_261">d_x += [control_xs[j + k - p]] </span>
<span id="th_261" class="t s5_261">d_y += [control_ys[j + k - p]] </span>
<span id="ti_261" class="t s5_261">d_w += [control_ws[j + k - p]] </span>
<span id="tj_261" class="t s5_261">for r in range(1, p+1): </span>
<span id="tk_261" class="t s5_261">for j in reversed(range(r, p+1)): </span>
<span id="tl_261" class="t s5_261">a = (t - knot[j+k-p]) / (knot[j+1+k-r] - knot[j+k-p]) </span>
<span id="tm_261" class="t s5_261">d_x[j] = (1.0 - a) * d_x[j-1] + a * d_x[j] </span>
<span id="tn_261" class="t s5_261">d_y[j] = (1.0 - a) * d_y[j-1] + a * d_y[j] </span>
<span id="to_261" class="t s5_261">d_w[j] = (1.0 - a) * d_w[j-1] + a * d_w[j] </span>
<span id="tp_261" class="t s5_261">return [d_x[p] / d_w[p], d_y[p] / d_w[p]] </span>
<span id="tq_261" class="t s3_261">The algorithm evaluates the NURBS surface given by arrays of control points, weights, </span>
<span id="tr_261" class="t s3_261">the knot vector, and the degree value in </span><span id="ts_261" class="t s6_261">t</span><span id="tt_261" class="t s3_261">. But to do this, it also needs to know what </span>
<span id="tu_261" class="t s3_261">segment the </span><span id="tv_261" class="t s6_261">t </span><span id="tw_261" class="t s3_261">corresponds to. For this purpose, it uses another function that finds out </span>
<span id="tx_261" class="t s3_261">the knot index for the interval containing the </span><span id="ty_261" class="t s6_261">t </span><span id="tz_261" class="t s3_261">value: </span>
<span id="t10_261" class="t s7_261">index_in_knots(t, knot). </span>
<span id="t11_261" class="t s5_261">def index_in_knots(t, nurbs_knot): </span>
<span id="t12_261" class="t s5_261">for i in range(len(nurbs_knot) - 1): </span>
<span id="t13_261" class="t s5_261">if t &gt;= nurbs_knot[i] and t &lt; nurbs_knot[i+1]: </span>
<span id="t14_261" class="t s5_261">return i </span>
<span id="t15_261" class="t s5_261">return -1 </span>
<span id="t16_261" class="t s3_261">Now all we have to do is feed it the data for the circle model, and we get this data: </span>
<span id="t17_261" class="t s7_261">sr2i = 1.0 / (2**0.5) </span>
<span id="t18_261" class="t s5_261">xs = [1.0, </span><span id="t19_261" class="t s5_261">sr2i, </span><span id="t1a_261" class="t s5_261">0.0, -sr2i, -1.0, -sr2i, </span><span id="t1b_261" class="t s5_261">0.0, </span><span id="t1c_261" class="t s5_261">sr2i, </span><span id="t1d_261" class="t s5_261">1.0] </span>
<span id="t1e_261" class="t s5_261">ys = [0.0, </span><span id="t1f_261" class="t s5_261">sr2i, </span><span id="t1g_261" class="t s5_261">1.0, </span><span id="t1h_261" class="t s5_261">sr2i, </span><span id="t1i_261" class="t s5_261">0.0, -sr2i, -1.0, -sr2i, </span><span id="t1j_261" class="t s5_261">0.0] </span>
<span id="t1k_261" class="t s5_261">ws = [1.0, </span><span id="t1l_261" class="t s5_261">sr2i, </span><span id="t1m_261" class="t s5_261">1.0, </span><span id="t1n_261" class="t s5_261">sr2i, </span><span id="t1o_261" class="t s5_261">1.0, </span><span id="t1p_261" class="t s5_261">sr2i, </span><span id="t1q_261" class="t s5_261">1.0, </span><span id="t1r_261" class="t s5_261">sr2i, </span><span id="t1s_261" class="t s5_261">1.0] </span>
<span id="t1t_261" class="t s5_261">n = len(xs) </span>
<span id="t1u_261" class="t s5_261">knot = [0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 4]; </span>
<span id="t1v_261" class="t s5_261">degree = 2; </span>
<span id="t1w_261" class="t s8_261">Listing 7.11 </span><span id="t1x_261" class="t s8_261">De Boor’s algorithm </span>
<span id="t1y_261" class="t s9_261">t is the parameter in which we want to </span>
<span id="t1z_261" class="t s9_261">evaluate the curve; control_xs is the </span>
<span id="t20_261" class="t s9_261">list of control points’ x coordinates; </span>
<span id="t21_261" class="t s9_261">control_ys is the list of y coordinates; </span>
<span id="t22_261" class="t s9_261">control_ws is the list of point weights; </span>
<span id="t23_261" class="t s9_261">knot is the knot vector; </span>
<span id="t24_261" class="t s9_261">and p is the degree. </span>
<span id="t25_261" class="t s9_261">The function returns a </span>
<span id="t26_261" class="t s9_261">pair of coordinates (x, y) </span>
<span id="t27_261" class="t s9_261">for every t. </span>
<span id="t28_261" class="t s9_261">The function accepts the parameter </span>
<span id="t29_261" class="t s9_261">value and the knot vector. </span>
<span id="t2a_261" class="t s9_261">If a parameter is found between two </span>
<span id="t2b_261" class="t s9_261">adjacent values of the knot vector, the </span>
<span id="t2c_261" class="t s9_261">index of the first value is returned. </span>
<span id="t2d_261" class="t s9_261">The magic </span>
<span id="t2e_261" class="t s9_261">constant that </span>
<span id="t2f_261" class="t s9_261">is the inverse </span>
<span id="t2g_261" class="t s9_261">of the square </span>
<span id="t2h_261" class="t s9_261">root of 2 </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
